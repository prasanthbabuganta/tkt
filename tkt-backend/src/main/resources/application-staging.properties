# ================================================================
# TKT Backend - Staging Environment Configuration
# Active Profile: staging
# GCP Region: asia-south1 (Mumbai, India)
# Usage: -Dspring.profiles.active=staging or SPRING_PROFILES_ACTIVE=staging
# ================================================================

# Database Configuration (GCP Cloud SQL - Staging)
# Use environment variables for actual values
# Connection via Cloud SQL Socket Factory
spring.datasource.url=${DB_URL}
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}

# Cloud SQL Socket Factory (for GCP deployment)
spring.cloud.gcp.sql.enabled=true
spring.cloud.gcp.sql.database-name=tkt
spring.cloud.gcp.sql.instance-connection-name=${CLOUD_SQL_INSTANCE:tkt-backend-staging:asia-south1:tkt-db-staging}

# JPA/Hibernate - Staging Settings
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false

# Logging - Moderate verbosity for staging
logging.level.root=INFO
logging.level.com.example.thekingstemple=DEBUG
logging.level.org.springframework.security=INFO
logging.level.org.springframework.web=INFO

# JSON Logging for GCP Cloud Logging
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n

# JWT Configuration - Use environment variables
jwt.secret=${JWT_SECRET}
jwt.access-token-expiry=${JWT_ACCESS_TOKEN_EXPIRY:2592000000}
jwt.refresh-token-expiry=${JWT_REFRESH_TOKEN_EXPIRY:5184000000}

# Encryption - Use environment variable
encryption.secret.key=${ENCRYPTION_SECRET_KEY}

# Admin Seed - Use environment variables
admin.seed.mobile=${ADMIN_SEED_MOBILE}
admin.seed.pin=${ADMIN_SEED_PIN}

# Actuator - Limited exposure for staging
management.endpoint.health.show-details=when-authorized
management.endpoints.web.exposure.include=health,info,metrics,prometheus

# Error Handling - Hide stack traces in staging
server.error.include-stacktrace=never
server.error.include-exception=false

# Connection Pool - Moderate pool size
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5

# GCP-specific configurations
# Graceful shutdown for Cloud Run
server.shutdown=graceful
spring.lifecycle.timeout-per-shutdown-phase=30s
